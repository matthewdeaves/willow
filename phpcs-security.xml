<?xml version="1.0"?>
<ruleset name="WillowCMS Security">
    <description>Security rules for Willow CMS based on phpcs-security-audit</description>

    <!-- Include all security rules -->
    <rule ref="Security"/>

    <!-- Scan source files -->
    <file>src/</file>

    <!-- File extensions to check -->
    <arg name="extensions" value="php"/>

    <!-- Show progress -->
    <arg value="p"/>

    <!-- Use colors -->
    <arg name="colors"/>

    <!-- Show sniff codes in reports -->
    <arg value="s"/>

    <!--
        Paranoia mode settings:
        0 = disabled (fewer false positives, may miss some issues)
        1 = enabled (more thorough, more false positives)
        Default is 1, we use 0 for less noise in CI
    -->
    <config name="ParanoiaMode" value="0"/>

    <!-- Exclude test files from security scanning -->
    <exclude-pattern>*/tests/*</exclude-pattern>
    <exclude-pattern>*/vendor/*</exclude-pattern>
    <exclude-pattern>*/tmp/*</exclude-pattern>
    <exclude-pattern>*/logs/*</exclude-pattern>

    <!-- Exclude specific rules that don't apply well to CakePHP -->
    <!-- CakePHP uses its own CSRF protection middleware -->
    <rule ref="Security.BadFunctions.CryptoFunctions">
        <exclude-pattern>*/Service/Api/*</exclude-pattern>
    </rule>

</ruleset>
